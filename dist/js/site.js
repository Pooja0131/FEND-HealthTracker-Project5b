!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.RadialProgressChart=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(b,c){function f(a){var b=m[a.index];return b?b:(b=0===a.index?h.options.diameter/2:n[a.index-1]+h.options.stroke.gap,m[a.index]=b,b)}function g(a){var b=n[a.index];return b?b:(b=m[a.index]+h.options.stroke.width,n[a.index]=b,b)}if(e="undefined"!=typeof window&&window.d3?window.d3:"undefined"!=typeof a?a("d3"):void 0,!e)throw new Error("d3 object is missing. D3.js library has to be loaded before.");var h=this;h.options=d.normalizeOptions(c);var i=h.options.series,j=15+2*(h.options.diameter/2+h.options.stroke.width*h.options.series.length+(h.options.stroke.gap*h.options.series.length-1)),k=j,l=2*Math.PI,m=[],n=[];h.progress=e.svg.arc().startAngle(0).endAngle(function(a){return a.percentage/100*l}).innerRadius(f).outerRadius(g).cornerRadius(function(a){var b=a.percentage>=90?.1*(100-a.percentage):1;return h.options.stroke.width/2*b});var o=e.svg.arc().startAngle(0).endAngle(l).innerRadius(f).outerRadius(g);h.svg=e.select(b).append("svg").attr("width",j).attr("height",k).append("g").attr("transform","translate("+j/2+","+k/2+")");var p=h.svg.append("svg:defs");i.forEach(function(a){if(a.color.linearGradient||a.color.radialGradient){var b=d.Gradient.toSVGElement("gradient"+a.index,a.color);p.node().appendChild(b)}}),p=h.svg.append("svg:defs");var q="dropshadow-"+Math.random(),r=p.append("filter").attr("id",q);h.options.shadow.width>0&&(r.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",h.options.shadow.width).attr("result","blur"),r.append("feOffset").attr("in","blur").attr("dx",1).attr("dy",1).attr("result","offsetBlur"));var s=r.append("feMerge");s.append("feMergeNode").attr("in","offsetBlur"),s.append("feMergeNode").attr("in","SourceGraphic"),h.options.center&&h.svg.append("text").attr("class","rbc-center-text").attr("text-anchor","middle").attr("x",h.options.center.x+"px").attr("y",h.options.center.y+"px").selectAll("tspan").data(h.options.center.content).enter().append("tspan").attr("dominant-baseline",function(){return 1===h.options.center.content.length?"central":void 0}).attr("class",function(a,b){return"rbc-center-text-line"+b}).attr("x",0).attr("dy",function(a,b){return b>0?"1.1em":void 0}).each(function(a){"function"==typeof a&&(this.callback=a)}).text(function(a){return"string"==typeof a?a:""}),h.field=h.svg.selectAll("g").data(i).enter().append("g"),h.field.append("path").attr("class","progress").attr("filter","url(#"+q+")"),h.field.append("path").attr("class","bg").style("fill",function(a){return a.color.background}).style("opacity",.2).attr("d",o),h.field.append("text").classed("rbc-label rbc-label-start",!0).attr("dominant-baseline","central").attr("x","10").attr("y",function(a){return-(h.options.diameter/2+a.index*(h.options.stroke.gap+h.options.stroke.width)+h.options.stroke.width/2)}).text(function(a){return a.labelStart}),h.update()}var e;d.prototype.update=function(a){var b=this;if(a){"number"==typeof a&&(a=[a]);var c;Array.isArray(a)?c=a:"object"==typeof a&&(c=a.series||[]);for(var d=0;d<c.length;d++){this.options.series[d].previousValue=this.options.series[d].value;var f=c[d];"number"==typeof f?this.options.series[d].value=f:"object"==typeof f&&(this.options.series[d].value=f.value)}}b.options.series.forEach(function(a){a.fromPercentage=a.percentage?a.percentage:5,a.percentage=100*(a.value-b.options.min)/(b.options.max-b.options.min)});var g=b.svg.select("text.rbc-center-text");b.field.select("path.progress").interrupt().transition().duration(b.options.animation.duration).delay(function(a,c){return c*b.options.animation.delay}).ease("elastic").attrTween("d",function(a){var c=e.interpolateNumber(a.fromPercentage,a.percentage);return function(d){return a.percentage=c(d),b.progress(a)}}).tween("center",function(a){if(b.options.center){var c=b.options.round?e.interpolateRound:e.interpolateNumber,d=c(a.previousValue||0,a.value);return function(b){g.selectAll("tspan").each(function(){this.callback&&e.select(this).text(this.callback(d(b),a.index,a))})}}}).tween("interpolate-color",function(a){if(a.color.interpolate&&2==a.color.interpolate.length){var b=e.interpolateHsl(a.color.interpolate[0],a.color.interpolate[1]);return function(c){var d=b(a.percentage/100);e.select(this).style("fill",d),e.select(this.parentNode).select("path.bg").style("fill",d)}}}).style("fill",function(a){return a.color.solid?a.color.solid:a.color.linearGradient||a.color.radialGradient?"url(#gradient"+a.index+")":void 0})},d.prototype.destroy=function(){this.svg.remove(),delete this.svg},d.normalizeOptions=function(a){a&&"object"==typeof a||(a={});for(var b={diameter:a.diameter||100,stroke:{width:a.stroke&&a.stroke.width||40,gap:a.stroke&&a.stroke.gap||2},shadow:{width:a.shadow&&null!==a.shadow.width?a.shadow.width:4},animation:{duration:a.animation&&a.animation.duration||1750,delay:a.animation&&a.animation.delay||200},min:a.min||0,max:a.max||100,round:void 0!==a.round?!!a.round:!0,series:a.series||[],center:d.normalizeCenter(a.center)},c=new d.ColorsIterator,e=0,f=b.series.length;f>e;e++){var g=a.series[e];"number"==typeof g&&(g={value:g}),b.series[e]={index:e,value:g.value,labelStart:g.labelStart,color:d.normalizeColor(g.color,c)}}return b},d.normalizeColor=function(a,b){if(a?"string"==typeof a?a={solid:a}:Array.isArray(a)?a={interpolate:a}:"object"==typeof a&&(a.solid||a.interpolate||a.linearGradient||a.radialGradient||(a.solid=b.next())):a={solid:b.next()},a.interpolate&&2!==a.interpolate.length)throw new Error("interpolate array should contain two colors");if((a.linearGradient||a.radialGradient)&&(!a.stops||!Array.isArray(a.stops)||2!==a.stops.length))throw new Error("gradient syntax is malformed");return a.background||(a.solid?a.background=a.solid:a.interpolate?a.background=a.interpolate[0]:(a.linearGradient||a.radialGradient)&&(a.background=a.stops[0]["stop-color"])),a},d.normalizeCenter=function(a){return a?(a.constructor!==Object&&(a={content:a}),a.content=a.content||[],a.x=a.x||0,a.y=a.y||0,Array.isArray(a.content)||(a.content=[a.content]),a):null},d.Gradient=function(){function a(){}return a.toSVGElement=function(a,b){var c=b.linearGradient?"linearGradient":"radialGradient",d=e.select(document.createElementNS(e.ns.prefix.svg,c)).attr(b[c]).attr("id",a);return b.stops.forEach(function(a){d.append("svg:stop").attr(a)}),this.background=b.stops[0]["stop-color"],d.node()},a}(),d.ColorsIterator=function(){function a(){this.index=0}return a.DEFAULT_COLORS=["#1ad5de","#a0ff03","#e90b3a","#ff9500","#007aff","#ffcc00","#5856d6","#8e8e93"],a.prototype.next=function(){return this.index===a.DEFAULT_COLORS.length&&(this.index=0),a.DEFAULT_COLORS[this.index++]},a}(),"undefined"!=typeof b&&(b.exports=d)},{d3:void 0}]},{},[1])(1)});var app=app||{};app.FoodModel=Backbone.Model.extend({dafaults:{name:"",calories:"",servings:0,serveSize:""}});var app=app||{},SelectedFoodCollection=Backbone.Collection.extend({model:app.FoodModel,localStorage:new Backbone.LocalStorage("selected-foods-backbone")});app.SelectedFoodCollection=new SelectedFoodCollection;var app=app||{},FoodResultCollection=Backbone.Collection.extend({model:app.FoodModel,localStorage:new Backbone.LocalStorage("food-results-backbone")});app.FoodResultCollection=new FoodResultCollection;var app=app||{};app.SelectedFoodView=Backbone.View.extend({tagName:"tr",template:_.template($("#user-selected-template").html()),events:{"click .destroy":"removeFood"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"all",this.render)},render:function(){return this.$el.html(this.template(this.model.attributes)),this},removeFood:function(){this.model.destroy(),$(".calories").empty(),app.EventBus.trigger("callRadar"),0===app.SelectedFoodCollection.length&&($(".list-head").hide(),$(".eaten-food-heading").addClass("hidden"))}});var app=app||{};app.FoodResultsView=Backbone.View.extend({tagName:"tr",template:_.template($("#results-template").html()),events:{"click .food-select-button":"showDetails"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove)},render:function(){return this.$el.html(this.template(this.model.attributes)),this},showDetails:function(){$("html, body").animate({scrollTop:$(".food-table").offset().top},600),$(".food-table").removeClass("hidden");var a=this.model.get("calories")*$("#num-servings").val();$("#food-search-bar").val(this.model.get("name")),$("#serving-size").html(this.model.get("serveSize")),$("#serving-calories").html(this.model.get("calories")),$("#calories-eaten").html(a)}});var app=app||{};app.AppView=Backbone.View.extend({el:".calorie-tracker-app",caloriesTemplate:_.template($("#calories-template").html()),recommendedCaloriesTemplate:_.template($("#recommended-calories-template").html()),allowedCaloriesTemplate:_.template($("#allowed-calories-template").html()),events:{"click #about-you-button":"showActivity","click #final-about-you-button":"showApp","click .activity-group":"calculateAllowedCalories","click #edit-button":"showAboutMe","keyup .food-input-box":"searchFood","click #clear-button":"clearResults","keyup #num-servings":"updateCalories","click #add-food":"addEatenFood"},initialize:function(){app.EventBus.bind("callRadar",this.updateRadar),$(".information").removeClass("hidden"),$(".BMR-form").removeClass("hidden");this.listenTo(app.FoodResultCollection,"add",this.addFoodResult),this.listenTo(app.SelectedFoodCollection,"add",this.displayFoodEaten),this.listenTo(app.SelectedFoodCollection,"reset",this.displayAllFoodEaten),this.listenTo(app.SelectedFoodCollection,"all",this.calculateCalories),app.SelectedFoodCollection.fetch(),app.FoodResultCollection.fetch()},showActivity:function(){$("div.activity-level").removeClass("hidden"),$(".BMR-form").addClass("hidden");var a,b=parseInt($("#feet").val()),c=parseInt($("#inch").val());a=12*b+c;var d=parseInt($("#lbs").val()),e=parseInt($("#age").val()),f=$("#gender").val();return"female"==f?bmr=655+4.35*d+4.7*a-4.7*e:bmr=66+6.23*d+12.7*a-6.8*e,!1},calculateAllowedCalories:function(){var a=$('input[name="activity-level"]:checked').val();return"SEDENTARY"==a?cal=parseInt(1.2*bmr):"LIGHT"==a?cal=parseInt(1.375*bmr):"MEDIUM"==a?cal=parseInt(1.55*bmr):"HEAVY"==a?cal=parseInt(1.725*bmr):cal=parseInt(1.9*bmr),$("html, body").animate({scrollTop:$(".recommended-calories").offset().top},600),$(".allowed-calories").html(this.allowedCaloriesTemplate({totalAllowedCalories:cal})),$(".recommended-calories").html(this.recommendedCaloriesTemplate({totalRecommendedCalories:cal})),!1},showApp:function(){$(".information").addClass("hidden"),$(".add-food-box").removeClass("hidden"),$(".app-heading").removeClass("hidden"),0===totalCaloriesIntake?($(".eaten-food-heading").addClass("hidden"),$(".user-selected-food").addClass("hidden")):($(".eaten-food-heading").removeClass("hidden"),$(".user-selected-food").removeClass("hidden")),$(".food-input-box").focus(),this.updateRadar()},updateRadar:function(){var a;a=0===totalCaloriesIntake?new RadialProgressChart(".calories",{diameter:100,min:0,max:cal,round:!0,stroke:{width:20},shadow:{width:0},series:[{value:0,color:{solid:"#A52A2A",background:"red"}}],center:{content:["0"," of "+cal+" calories"]}}):new RadialProgressChart(".calories",{diameter:100,min:0,max:cal,round:!0,stroke:{width:20},shadow:{width:0},series:[{color:{solid:"#A52A2A",background:"red"}}],center:{content:[function(a){return a}," of "+cal+" calories"]}}),$(".container").html(a.update(totalCaloriesIntake))},showAboutMe:function(){return $(".calories").empty(),$(".app-heading").addClass("hidden"),$(".add-food-box").addClass("hidden"),$(".recommended-calories").html(""),$(".activity-level").addClass("hidden"),$(".information").removeClass("hidden"),$(".BMR-form").removeClass("hidden"),$(".search-results").empty(),$(".recipe-div").empty(),!1},addFoodResult:function(a){var b=new app.FoodResultsView({model:a});$(".results-list").append(b.render().el)},updateCalories:function(){var a=$("#serving-calories").html()*$("#num-servings").val();$("#calories-eaten").html(a)},displayFoodEaten:function(a){var b=new app.SelectedFoodView({model:a});$(".food-list").append(b.render().el)},displayAllFoodEaten:function(){this.$(".user-selected-food").html(""),app.SelectedCollection.each(this.addOne,this)},addEatenFood:function(a){var b=new app.FoodModel({name:$("#food-search-bar").val(),calories:$("#calories-eaten").text(),servings:$("#num-servings").val(),serveSize:$("#serving-size").text()});app.SelectedFoodCollection.create(b),$(".eaten-food-heading").removeClass("hidden"),$(".user-selected-food").removeClass("hidden"),$(".search-results").addClass("hidden"),$(".food-table").addClass("hidden"),$(".calories").empty(),$("#food-search-bar").val(""),$("#food-search-bar").attr("placeholder","What did you eat? Search here for calorie count..."),this.render(),this.updateRadar()},calculateCalories:function(){totalCaloriesIntake=0;var a=0;app.SelectedFoodCollection.forEach(function(b){return a=b.get("calories"),totalCaloriesIntake+=parseInt(a),totalCaloriesIntake}),$(".total-calories").html(this.caloriesTemplate({totalCalories:totalCaloriesIntake}))},clearResults:function(){return _.invoke(app.FoodResultCollection.toArray(),"destroy"),this.$("#food-search-bar").val(""),$(".search-results").addClass("hidden"),$(".recipe-div").addClass("hidden"),!1},searchFood:function(a){$(".results-list").empty(),$(".recipe-table").empty(),$(".search-results").addClass("hidden"),$(".recipe-div").addClass("hidden");var b=$("#food-search-bar").val();if(null!==b&&""!==b||a.which!==ENTER_KEY){if(a.which===ENTER_KEY&&b){$(".loader").removeClass("hidden"),$(".search-results").removeClass("hidden"),$(".recipe-div").removeClass("hidden"),$(".no-results").hide();var c="https://api.nutritionix.com/v1_1/search/"+b+"?results=0:10&fields=brand_name,item_name,brand_id,item_id,item_type,item_description,nf_calories,nf_serving_size_qty,nf_serving_size_unit,images_front_full_url&appId=1885a928&appKey=a9371e3fd3a0d38f5870b6070506ffed";$.ajax({method:"GET",url:c,dataType:"json",success:function(a){if(setTimeout("$('.loader').addClass('hidden');",500),$(".search-results").removeClass("hidden"),$(".recipe-div").removeClass("hidden"),a.hits.length>0)for(var b=0;b<a.hits.length;b++){var c=new app.FoodModel({name:a.hits[b].fields.brand_name+" "+a.hits[b].fields.item_name,calories:Math.ceil(a.hits[b].fields.nf_calories),servings:0,serveSize:a.hits[b].fields.nf_serving_size_qty+" "+a.hits[b].fields.nf_serving_size_unit});app.FoodResultCollection.contains(c)||app.FoodResultCollection.create(c)}else{var d='<h4 class="no-results">NO RESULTS FOUND.<br>';$(".results-list").prepend(d)}},error:function(a,b,c){setTimeout("$('.loader').hide();",2500),$(".results-list").append("<p>Couldn't get Nutritionix data. Check your internet connection or try again later.</p>")}}),this.searchRecipe()}}else{var d='<h4 class="no-results">PLEASE ENTER SOMETHING!<br>';$(".search-box").append(d)}},searchRecipe:function(){var a,b,c,d,e=$("#food-search-bar").val(),f="https://api.edamam.com/search?q="+e+"&app_id=62b26d1f&app_key=2b8f1a0bdbc896e3542e3aaa98093f10",g=setTimeout(function(){$(".recipe-table").append("<p> Failed to get Edamam data. Sorry! </p>")},9e3);$.ajax({method:"GET",url:f,dataType:"jsonp",success:function(e){if(e.hits.length>0)for(var f=0;f<e.hits.length;f++)a=e.hits[f].recipe.label,b=e.hits[f].recipe.shareAs,d=e.hits[f].recipe.calories,c=e.hits[f].recipe.image,$(".recipe-table").append(_.template($("#recipe-template").html())({recipeImage:c,recipeLink:b,recipeName:a,recipeCalories:Math.ceil(d)}));else{var h='<h4 class="no-results">NO RESULTS FOUND.<br>';$(".recipe-table").prepend(h)}clearTimeout(g)},error:function(a,b,c){setTimeout("$('.loader').hide();",2500),$(".recipe-table").append("<p>"+a.status+" "+c+"! Couldn't get Edamam data. Check your internet connection or try again later.</p>")}})}});var app=app||{},ENTER_KEY=13;$(function(){new app.AppView}),app.EventBus=_.extend({},Backbone.Events);